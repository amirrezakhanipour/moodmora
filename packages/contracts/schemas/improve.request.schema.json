{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "moodmora://schemas/improve.request.schema.json",
  "title": "ImproveRequest",
  "type": "object",
  "additionalProperties": false,
  "required": ["input"],
  "properties": {
    "input": {
      "type": "object",
      "additionalProperties": false,
      "required": ["draft_text"],
      "properties": {
        "draft_text": { "type": "string", "minLength": 1 },
        "context": { "type": "string" },
        "output_variant": { "type": "string", "enum": ["AUTO", "FA_SCRIPT", "FINGLISH", "EN"] },
        "hard_mode": { "type": "boolean" },
        "contact_id": { "type": "string" },

        "flirt_mode": { "type": "string", "enum": ["off", "subtle", "playful", "direct"] },
        "dating_stage": {
          "type": "string",
          "enum": ["first_msg", "early_chat", "planning", "reconnect", "post_date"]
        },
        "dating_vibe": { "type": "string", "enum": ["fun", "classy", "direct", "shy", "friendly"] }
      }
    },

    "voice": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "enabled": { "type": "boolean" },
        "variant": { "type": "string", "enum": ["AUTO", "FA_SCRIPT", "FINGLISH", "EN"] },
        "profile": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "warmth": { "type": "number", "minimum": 0, "maximum": 1 },
            "directness": { "type": "number", "minimum": 0, "maximum": 1 },
            "brevity": { "type": "number", "minimum": 0, "maximum": 1 },
            "formality": { "type": "number", "minimum": 0, "maximum": 1 },
            "emoji_rate": { "type": "number", "minimum": 0, "maximum": 1 },
            "do_not_use": { "type": "array", "items": { "type": "string", "minLength": 1 }, "maxItems": 50 }
          }
        }
      }
    },

    "contact": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "display_name"],
      "properties": {
        "id": { "type": "string", "minLength": 1 },
        "display_name": { "type": "string", "minLength": 1 },
        "relation_tag": {
          "type": "string",
          "enum": ["boss", "coworker", "friend", "family", "partner", "client", "other"]
        },
        "style_offsets": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "warmth_offset": { "type": "integer", "minimum": -30, "maximum": 30 },
            "directness_offset": { "type": "integer", "minimum": -30, "maximum": 30 },
            "brevity_offset": { "type": "integer", "minimum": -30, "maximum": 30 },
            "formality_offset": { "type": "integer", "minimum": -30, "maximum": 30 },
            "emoji_rate_offset": { "type": "integer", "minimum": -30, "maximum": 30 }
          }
        },
        "sensitivities": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "hates_sarcasm": { "type": "boolean" },
            "hates_commands": { "type": "boolean" },
            "sensitive_to_always_never": { "type": "boolean" },
            "conflict_sensitive": { "type": "boolean" }
          }
        },
        "forbidden_words": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 },
          "maxItems": 50
        }
      }
    }
  }
}